#!/usr/bin/env bash

MODEL="gpt-4o-mini"
prompt="$*"

response=$(curl -s https://api.openai.com/v1/responses \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -H "Content-Type: application/json" \
  -d "{\"model\":\"$MODEL\",\"input\":\"$prompt\"}")

error=$(echo "$response" | jq -r '.error.message // empty')

if [[ -n "$error" ]]; then
  echo "ERROR: $error"
  exit 1
fi

echo "$response" | jq -r '.output[0].content[0].text'
